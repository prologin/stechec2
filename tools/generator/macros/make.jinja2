{% macro common_flags() -%}
CXXFLAGS = -ggdb3 -Wall -std=c++17 -fPIC
CPPFLAGS = -MMD -MP
{%- endmacro %}

{% macro common_rules(lang) -%}
clean:
	@$(RM) _lang # In case the tar rule was interrupted
	$(RM) $(objs) $(deps)

distclean: clean
	$(RM) champion.so champion.tgz

champion.tgz: $(SOURCES)
	@echo "{{ lang }}" > _lang
	tar czf $@ $^ _lang
	@rm _lang

tar: champion.tgz

.PHONY: tar clean distclean

-include $(deps)
{%- endmacro %}
